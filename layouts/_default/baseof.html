<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

{{ partial "head.html" . }}

<body class="black-80">

{{- if not .Params.no_header }}
{{- partial "header.html" . }}
{{ end }}

{{ block "main" . }}
{{ end }}

{{- if not .Params.no_newsletter_cta }}
{{- partial "newsletter_form.html" . }}
{{- end }}

{{- if not .Params.no_footer }}
{{ partial "footer.html" . }}
{{ end }}

<script>
// loadDeferImages(): https://varvy.com/pagespeed/defer-images.html
var deferImgs = document.getElementsByTagName('img'),
    i = 0, n = deferImgs.length, img, x, t = 0;
for (; i < n; i++) {
  img = deferImgs[i];
  if (x = img.getAttribute('data-src')) { img.setAttribute('src', x); t++; }
}
console.log(t + " images defered");
</script>

{{- if ne (getenv "HUGO_ENV") "production" }}
<script>
  console.log("HUGO_ENV: {{ getenv "HUGO_ENV" }}");
  console.log("URL: {{ .URL }}");
  console.log(".Page.Description: {{ .Description }}");
  console.log(".Page.Keywords: {{ .Keywords }}");
  {{- $images := findRE "src=\"(.+?).jpg\"" .Content 6 }}
  console.log("images: {{ $images }}");
</script>
{{ end }}
</body>
</html>
