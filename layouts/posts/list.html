{{ define "main" }}
<section class="full center pl3 pl4-ns bt b--light-gray bg-li">

  <div class="flex flex-column items-center mt3">
    <input id="search-field" onkeyup="search()" placeholder="Search keywords"
    class= "f6 f5-l fw1 input-reset ba b--black-20 br0 black-80 bg-white pa2 w5"
    />
  </div>

  <h1 class="f4 f3-ns fw4 lh-title mb0 pb2">All Posts</h1>
  <!-- Ranges through content/post/*.md -->
  <div class="grid w-100">
  <div class="grid-sizer w-100 w-50-ns w-50-m w-third-l"></div>
  {{ range .Pages }}
    <div class="grid-item w-100 w-50-ns w-50-m w-third-l
                pr3 pr4-ns mb4
                box-masonry bg-white" id="{{ .UniqueID }}">
      {{ if .Params.cover_image }}
      <!-- need an <a> tag wraping image in-order to hover-overlay and hover-icon work! -->
      <a class="box-masonry-image with-hover-overlay with-hover-icon" href="{{ .Permalink }}">
        <img src="{{ .Params.cover_image }}" class="w-100">
      </a>
      {{ end }}
      <a class="db link black-80 hover-silver" href="{{ .Permalink }}">
        <article class="lh-copy bb bt-0 br-0 bl-0 b--light-blue b--dashed">
          <h3 class="f4 f3-ns fw4 fw6-ns">{{ .Title | safeHTML }}</h3>
          <p class="f5 fw3 lh-copy mv2">
            {{ with .Params.description }}{{ . | safeHTML }}{{ else }}{{  .Summary | safeHTML }}{{ end }}
          </p>
          <div class="f6 fw3 gray mt0">
            <time>{{ .Date.Format "Jan 2, 2006" }}</time>
            <span class="ttl">&middot; {{ .ReadingTime }} {{ .Site.Data.settings.ui_text.minute_read }}</span>
          </div>
        </article>
      </a>
  </div>
  {{ end }}
</div>
</section>

{{ partial "masonry_layout.html" . }}
<script src="//cdnjs.cloudflare.com/ajax/libs/fuse.js/3.0.4/fuse.min.js"></script>
<script>

function bodauTiengViet(str) {
        str = str.toLowerCase();
        str = str.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g, "a");
        str = str.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g, "e");
        str = str.replace(/ì|í|ị|ỉ|ĩ/g, "i");
        str = str.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g, "o");
        str = str.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g, "u");
        str = str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g, "y");
        str = str.replace(/đ/g, "d");
        return str;
}

var posts = [
{{ range .Pages }}
  {
    id: "{{ .UniqueID }}",
    title: bodauTiengViet("{{ .Title | plainify }}"),
    desc: bodauTiengViet("{{ with .Params.description }}{{ . | plainify }}{{ else }}{{  .Summary | plainify }}{{ end }}")
  },
{{ end }}
];

var options = {
  threshold: 0.3,
  keys: ['title', 'author'],
  id: 'id'
}
var fuse = new Fuse(posts, options), results;
var items = document.getElementsByClassName("grid-item");
var searchField = document.getElementById("search-field");
function search() {
  var str = bodauTiengViet(searchField.value.trim());
  if (str.length == 0) { str = " "; }
  results = fuse.search(str);
  console.log(str, results);
  var item, i, n = items.length;
  for (i = 0; i < n; i++) {
    item = items[i];
    if ( results.indexOf(item.id) > -1 ) {
      item.style.display = 'block';
    } else {
      item.style.display = 'none';
    }
  }
  msnry.layout();
};
</script>

<!--
https://leap.hauntedthemes.com

<div class="grid">
<article class="post tag-lifestyle tag-culture tag-celebrity tag-hair tag-how-to grid-item">
  <div class="content-holder">
    <div class="post-meta has-image">
      <ul class="tags">
          <li><a href="/tag/lifestyle/" title="Lifestyle" class="tag tag-59c8db0bf999345c346421ea lifestyle">Lifestyle</a></li>
          <li><a href="/tag/culture/" title="Culture" class="tag tag-59c8db0bf999345c346421e3 culture">Culture</a></li>
          <li><a href="/tag/celebrity/" title="Celebrity" class="tag tag-59c8db0bf999345c346421e6 celebrity">Celebrity</a></li>
          <li><a href="/tag/hair/" title="Hair" class="tag tag-59c8db0bf999345c346421eb hair">Hair</a></li>
      </ul>
      <a class="img-holder" href="/what-are-the-latest-teen-fashion-styles/" title="What are the latest teen fashion styles?">
        <img src="/content/images/2017/09/picture-1.jpg" alt="What are the latest teen fashion styles?">
      </a>
      <time class="post-date" datetime="2017-09-24">September 24, 2017</time>
    </div>
    <h2 class="post-title"><a href="/what-are-the-latest-teen-fashion-styles/" title="What are the latest teen fashion styles?">What are the latest teen fashion styles?</a></h2>
    <p>Online programs are also more cost efficient. Get some basic costs figured out and see if you can make some money under</p>
  </div>
</article>

article .post-meta .img-holder:before{
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    z-index: 1;
    background: rgba(0, 0, 0, 0.75);
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
}

article .post-meta:hover .img-holder:before{
    opacity: 1;
}

article .post-meta.expand .img-holder{
    display: flex;
    width: 100%;
}


===
https://interfacelovers.com

<div style="background-color:#FFFCF5;" class="absolute z-0 color x-tall"></div>
<a href="https://interfacelovers.com/interviews/ryan-putnam" class="relative z-1 db interviewImage x-tall"
  data-src='https://interfacelovers.com/thumbs/interviews/ryan-putnam/ryan-putnam-509x600.jpg'></a>

<div style="background-color:#272c2d;" class="absolute z-0 color x-tall"></div>
<a href="https://interfacelovers.com/interviews/ryan-putnam" class="relative z-1 db interviewImage x-tall"
style="background-image: url('https://interfacelovers.com/thumbs/interviews/ryan-putnam/ryan-putnam-509x600.jpg';);"></a>

defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",
placeholder:null,delay:-1,combined:!1,attribute:"data-src",
srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",
retinaAttribute:"data-retina",loaderAttribute:"data-loader",
imageBaseAttribute:"data-imagebase"
 -->
{{ end }}
