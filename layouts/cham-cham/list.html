{{ define "head_bottom" }}
{{ end }}

{{ define "main" }}
<main class="full center pl3 pl4-ns bt b--light-gray">
  <session class="w-100">
      {{ template "section-template" (dict "section" . "depth" 1) }}
  </session>
</main>
{{ end }}

{{ define "section-template" }}

{{ if not ((len .section.Sections | eq 0) | and (len .section.Pages | eq 0)) }}
    {{ $scratch := newScratch }}
    {{ if eq .depth 1 }}
        <h{{ .depth }} class="dark-green">
            {{ if not .section.Parent.IsHome }}
            <a href="{{ .section.Parent.Permalink }}" class="dark-green">{{ .section.Parent.Title }}</a> /
            {{ end }}
            {{ .section.Title }}
        </h{{ .depth }}>
    {{ else }}
        {{ printf "<a href=\"%s\" class=\"dark-green\">%s</a>" .section.Permalink .section.Title | $scratch.Set "title" }}
        {{ if .prefix }}
            {{ printf "%s / %s" .prefix ($scratch.Get "title") | $scratch.Set "title" }}
        {{ end }}
        {{ if not (len .section.Pages | eq 0) }}
            <h{{ .depth }} class="dark-green">{{ $scratch.Get "title" | safeHTML }}</h{{ .depth }}>
        {{ end }}
    {{ end }}

    {{ if not (len .section.Pages | eq 0) }}
    {{ if eq .depth 1 }}
        {{ range .section.Pages }}
            {{ partial "post/selected.html" . }}
        {{ end }}
    {{ else }}
        {{ range .section.Pages | first 3 }}
            {{ partial "post/selected.html" . }}
        {{ end }}
    {{ end }}

    {{ if not (eq .depth 1) }}
    <a href="{{ .section.Permalink }}" class="f5 no-underline inline-flex items-center pa3 mb4 ba border-box grow">
      <span class="pr1">Xem thÃªm</span>
      <svg class="w1" data-icon="chevronRight" viewBox="0 0 32 32" style="fill:currentcolor">
        <title>chevronRight icon</title>
        <path d="M12 1 L26 16 L12 31 L8 27 L18 16 L8 5 z"></path>
      </svg>
    </a>
    {{ end }}
    {{ end }}

    {{ range .section.Sections }}
        {{ template "section-template" (dict "section" . "depth" 2 "prefix" ($scratch.Get "title") ) }}
    {{ end }}
{{ end }}
{{ end }}
